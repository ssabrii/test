language: ruby
addons:
  apt:
    packages:
      - postgresql-10
      - postgresql-client-10
  postgresql: 10

services:
  - postgresql

postgres:
  adapter: postgresql

before_install:
  - sudo sed -i 's/port = 5433/port = 5432/' /etc/postgresql/10/main/postgresql.conf
  - sudo cp /etc/postgresql/{9.6,10}/main/pg_hba.conf
  - sudo service postgresql stop
  - sudo /etc/init.d/postgresql start 10
  - sudo -u postgres psql -c 'SELECT version() AS version'

install: true

before_script:
  - psql -c 'create database travis_ci_test' -U postgres

script: 
  - sudo netstat -plunt |grep postgres
  - psql -V

notifications:
  slack:
   rooms:
      secure: QZXwcUP/cpjuphUPHZUl8e6OV0FhIJ7cy7q+mecfPtLfmckXK/6l+gONyk8mghZb7VHAEga4if4bi3xWc4lrqRF2QV9QC6GSG58lvTghj78UQLfxjsnmPPJwHX0ZP/RcvFL1sHmtg1MbyynaInnJE6kNhkPCXpd9yNzH7b78uqWhXy/GVUUpwFkcjJAXXPWrf4usmSYCfrPKRyK6EdWmgbg29YW4tveaI7ZLb65SeWFuCvTX/iWJGICFpRdR7ipQhSSkx/mEz8MYwlwV7wZ5H+hfZS/f7IkhXCvond/hCh5nxSK4rlzfrZo4vMEWKp8l5E98EKPxiuQxr/bMlGVLbgn53cS84HwzGWxnjJnMce+W6rYbJGZXRqFaMZS3saCOGgtuv1mRSIUsUmjTudDtB8o/Z9UqexoVTqlRiAEe62VKxP/mdW7Ai9seflN95Iu+sOgiAnXR6acML35MNCKg3WdLWaXNPspOMkITPFoGpXCdCKR4MnBg3chX5uhU6Tfo7MMdZoH1Bcs+IoP+W53e2l/2tf7tDXihu8NF0Mtel7kC+tGDcp9lmJ0IcmFQkDXTHwisYds0Dusg3RaiCHEsHNCpAOAQJSH+BmAXrXDAX0/Pns3YOudD3BcUc4uhWRAyTdJGzW9tPKYfxLyZWdYdQErc3KV65GsMeexZAMQstz8=
 
